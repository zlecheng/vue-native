import{_ as L}from"./TheFooter-Q43lmCYa.js";import{b1 as v,aV as N,l as y,b2 as x,b3 as T,F as $,J as n,D as b,E as V,C as s,I as l,B as c,b4 as C,aK as D,ao as K,z as q,v as F,w as E}from"./index-ByY1MUmQ.js";import{t as J}from"./common-pUSg97Vu.js";import{_ as z}from"./Checkbox-BH5kq6bq.js";import{_ as A}from"./Input-ChV5V0-M.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Eye-CthB5UBc.js";const M=""+new URL("login_banner-BD2eW0TC.webp",import.meta.url).href,P=""+new URL("logo-Bw3FJMyu.png",import.meta.url).href,W={toggleRole:u=>v.post("/auth/role/toggle",u),login:u=>v.post("/auth/login",u,{noNeedToken:!0}),getUser:()=>v.get("/user/detail")},j={class:"wh-full flex-col bg-[url(@/assets/images/login_bg.webp)] bg-cover"},G={class:"m-auto max-w-700 min-w-345 f-c-c rounded-8 bg-opacity-20 bg-cover p-12 card-shadow auto-bg"},H=n("div",{class:"hidden w-380 px-20 py-35 md:block"},[n("img",{src:M,class:"w-full",alt:"login_banner"})],-1),O={class:"w-320 flex-col px-20 py-32"},X={class:"f-c-c text-24 text-#6a6a6a font-normal"},Y=n("img",{src:P,class:"mr-12 h-50"},null,-1),Z=n("i",{class:"i-fe:user mr-12 opacity-20"},null,-1),Q=n("i",{class:"i-fe:lock mr-12 opacity-20"},null,-1),ee={class:"mt-20 flex items-center"},oe=n("i",{class:"i-fe:key mr-12 opacity-20"},null,-1),se=["src"],te={class:"mt-20 flex items-center"},me={__name:"index",setup(u){const B=N(),k=F(),m=E(),R="Panda",t=y({username:"",password:""}),_=y(""),p=J(()=>{_.value=`/api/auth/captcha?${Date.now()}`},500),f=x.get("loginInfo");f&&(t.value.username=f.username||"",t.value.password=f.password||""),p();function S(){t.value.username="admin",t.value.password="123456",d(!0)}const h=T("isRemember",!0),w=y(!1);async function d(i){const{username:e,password:r,captcha:g}=t.value;if(!e||!r)return $message.warning("请输入用户名和密码");if(!i&&!g)return $message.warning("请输入验证码");try{w.value=!0,$message.loading("正在验证，请稍后...",{key:"login"});const{data:a}=await W.login({username:e,password:r.toString(),captcha:g,isQuick:i});h.value?x.set("loginInfo",{username:e,password:r}):x.remove("loginInfo"),U(a)}catch(a){(a==null?void 0:a.code)===10003&&p(),$message.destroy("login"),console.error(a)}w.value=!1}async function U(i={}){B.setToken(i),$message.loading("登录中...",{key:"login"});try{if($message.success("登录成功",{key:"login"}),m.query.redirect){const e=m.query.redirect;delete m.query.redirect,k.push({path:e,query:m.query})}else k.push("/")}catch(e){console.error(e),$message.destroy("login")}}return(i,e)=>{const r=A,g=z,a=K,I=L;return q(),$("div",j,[n("div",G,[H,n("div",O,[n("h2",X,[Y,b(" "+V(s(R)),1)]),l(r,{value:s(t).username,"onUpdate:value":e[0]||(e[0]=o=>s(t).username=o),autofocus:"",class:"mt-32 h-40 items-center",placeholder:"请输入用户名",maxlength:20},{prefix:c(()=>[Z]),_:1},8,["value"]),l(r,{value:s(t).password,"onUpdate:value":e[1]||(e[1]=o=>s(t).password=o),class:"mt-20 h-40 items-center",type:"password","show-password-on":"mousedown",placeholder:"请输入密码",maxlength:20,onKeydown:e[2]||(e[2]=C(o=>d(),["enter"]))},{prefix:c(()=>[Q]),_:1},8,["value"]),n("div",ee,[l(r,{value:s(t).captcha,"onUpdate:value":e[3]||(e[3]=o=>s(t).captcha=o),class:"h-40 items-center",palceholder:"请输入验证码",maxlength:4,onKeydown:e[4]||(e[4]=C(o=>d(),["enter"]))},{prefix:c(()=>[oe]),_:1},8,["value"]),s(_)?(q(),$("img",{key:0,src:s(_),alt:"验证码",height:"40",class:"ml-12 w-80 cursor-pointer",onClick:e[5]||(e[5]=(...o)=>s(p)&&s(p)(...o))},null,8,se)):D("",!0)]),l(g,{class:"mt-20",checked:s(h),label:"记住我","on-update:checked":o=>h.value=o},null,8,["checked","on-update:checked"]),n("div",te,[l(a,{class:"h-40 flex-1 rounded-5 text-16",type:"primary",ghost:"",onClick:e[6]||(e[6]=o=>S())},{default:c(()=>[b(" 一键体验 ")]),_:1}),l(a,{class:"ml-32 h-40 flex-1 rounded-5 text-16",type:"primary",loading:s(w),onClick:e[7]||(e[7]=o=>d())},{default:c(()=>[b(" 登录 ")]),_:1},8,["loading"])])])]),l(I,{class:"py-12"})])}}};export{me as default};
